<html>
    <head>
        <meta charset="utf-8"/>

        <!-- INCLUDE JQUERY -->
        <script src="https://code.jquery.com/jquery-latest.js"></script>

        <!-- INCLUDE RR AND PYODIDE -->
        <script src="https://robotraconteur.github.io/robotraconteur_pyodide/pyodide.js"></script>  

        <!-- INCLUDE GOLDEN LAYOUT -->
        <!-- GoldenLayout needs jQuery to work -->
        <script type="text/javascript" src="http://code.jquery.com/jquery-1.11.1.min.js"></script>
        <!-- add GoldenLayout's main JS and CSS file, -->
        <script type="text/javascript" src="https://golden-layout.com/files/latest/js/goldenlayout.min.js"></script>
        <link type="text/css" rel="stylesheet" href="https://golden-layout.com/files/latest/css/goldenlayout-base.css" />
        <!-- goldenlayout-base.css contains purely the structural bits, so you also need a theme.  -->
        <!-- Just pick one of the available ones and include its CSS file -->
        <!-- <link type="text/css" rel="stylesheet" href="https://golden-layout.com/files/latest/css/goldenlayout-dark-theme.css" /> -->
        <link type="text/css" rel="stylesheet" href="https://golden-layout.com/files/latest/css/goldenlayout-light-theme.css" />

        <!-- INCLUDE BLOCKLY -->
        <script src="./blockly/blockly_compressed.js"></script>
        <script src="./blockly/blocks_compressed.js"></script>
        <!-- include blockly code generators -->
        <script src="./blockly/javascript_compressed.js"></script>
        <script src="./blockly/python_compressed.js"></script>
        <!-- include blockly custom blocks -->
        <!-- <script src="./blockly-customBlocks/print_div_block.js"></script> -->
        <script src="./blockly-customBlocks/jog_joint_blocks.js"></script>
        <script src="./blockly-customBlocks/jog_cartesian_blocks.js"></script>
        <script src="./blockly-customBlocks/camera_blocks.js"></script>
        <script src="./blockly-customBlocks/utils_blocks.js"></script>
        <script src="./blockly-customBlocks/tool_blocks.js"></script>
        <!-- include language for blockly msgs -->
        <script src="./blockly/msg/js/en.js"></script>

        <!-- INCLUDE CROPPER -->
        <link rel="stylesheet" href="./cropperjs/dist/cropper.css">
        <script src="./cropperjs/dist/cropper.js"></script>

        <!-- INCLUDE STYLES -->
        <link rel="stylesheet" type="text/css" href="styles.css">
    </head>
    
    <body>
         <!-- Golden Layout Containers -->
        <div id="wrapper">
            <ul id="menuContainer"></ul>
            <div id="layoutContainer"></div>

            <li id = "robotOptsContainer">
                <form>
                    <label for="chosen_robot">Select robot:</label>
                    <select name="available_robots" id="available_robots">
                        <!-- <option value="sawyer">Sawyer</option>
                        <option value="ur">UR</option>
                        <option value="abb">ABB</option> -->
                        <!-- <option value="4">4</option> -->
                    </select>
                </form>
                <button id="start_robot_btn" type="button" onclick="run_robot()">Start</button>
            </li> 

            <div id="saveLayoutStateContainer">
                <div class="btn-group">
                    <button id="saveLayoutState_btn" type="button">Save Current Layout State</button>
                    <button id="loadSavedLayoutState_btn" type="button">Reload with Saved Layout</button>
                    <button id="defaultLayoutState_btn" type="button">Reload with Default Layout</button>
                </div> 
            </div> 

            
        </div>

        <!-- General JS -->
        <!-- Auto robot discovery -->
        <script type="text/javascript" src="./scripts-discovery.js"></script>

        <script type="text/javascript" src="./scripts-robot.js"></script>
        <script type="text/javascript" src="./scripts-vision.js"></script>
        
        


        <!-- Content HTMLs -->
        <template id="template_JointSpaceControl">
            <table  id="table_JointSpaceControl" border="1" > <!-- border="1" > -->
                <Tr>
                    <TH align="center" COLSPAN="6"> <H3>Joint Space Control</H3> </TH>
                </Tr>
                <Tr>
                    <TH> <H4>Min<br>(deg)</H4></TH>
                    <TH> <H4></H4></TH>
                    <TH> <H4>Current<br>(deg)</H4></TH>
                    <TH> <H4></H4></TH>
                    <TH> <H4>Max<br>(deg)</H4></TH>
                    <TH> <H4>Angle Input<br>(deg)</H4></TH>
                </Tr>
                <tr>
                    <td> <div align="center" id="j1_neg_limit"> N/A </div> </td>
                    <td> <button id="j1_neg_btn" type="button">J1-</button></td>
                    <td> <div align="center" id="j1_angle_out"> N/A </div> </td>
                    <td> <button id="j1_pos_btn" type="button">J1+</button></td>
                    <td> <div align="center" id="j1_pos_limit"> N/A </div> </td>
                    <td> <input type="text" id="j1_angle_in" placeholder="deg_j1" value="0" > </td>
                </tr>
                <tr>
                    <td> <div align="center" id="j2_neg_limit"> N/A </div> </td>
                    <td> <button id="j2_neg_btn" type="button">J2-</button></td>
                    <td> <div align="center" id="j2_angle_out"> N/A </div> </td>
                    <td> <button id="j2_pos_btn" type="button">J2+</button></td>
                    <td> <div align="center" id="j2_pos_limit"> N/A </div> </td>
                    <td> <input type="text" id="j2_angle_in" placeholder="deg_2" value="0" > </td>
                </tr>         
                <tr>
                    <td> <div align="center" id="j3_neg_limit"> N/A </div> </td>
                    <td> <button id="j3_neg_btn" type="button">J3-</button></td>
                    <td> <div align="center" id="j3_angle_out"> N/A </div> </td>
                    <td> <button id="j3_pos_btn" type="button">J3+</button></td>
                    <td> <div align="center" id="j3_pos_limit"> N/A </div> </td>
                    <td> <input type="text" id="j3_angle_in" placeholder="deg_j3" value="0" > </td>
                </tr>      
                <tr>
                    <td> <div align="center" id="j4_neg_limit"> N/A </div> </td>
                    <td> <button id="j4_neg_btn" type="button">J4-</button></td>
                    <td> <div align="center" id="j4_angle_out"> N/A </div> </td>
                    <td> <button id="j4_pos_btn" type="button">J4+</button></td>
                    <td> <div align="center" id="j4_pos_limit"> N/A </div> </td>
                    <td> <input type="text" id="j4_angle_in" placeholder="deg_j4" value="0" > </td>
                </tr>  
                <tr>
                    <td> <div align="center" id="j5_neg_limit"> N/A </div> </td>
                    <td> <button id="j5_neg_btn" type="button">J5-</button></td>
                    <td> <div align="center" id="j5_angle_out"> N/A </div> </td>
                    <td> <button id="j5_pos_btn" type="button">J5+</button></td>
                    <td> <div align="center" id="j5_pos_limit"> N/A </div> </td>
                    <td> <input type="text" id="j5_angle_in" placeholder="deg_j5" value="0" > </td>
                </tr>               
                <tr>
                    <td> <div align="center" id="j6_neg_limit"> N/A </div> </td>
                    <td> <button id="j6_neg_btn" type="button">J6-</button></td>
                    <td> <div align="center" id="j6_angle_out"> N/A </div> </td>
                    <td> <button id="j6_pos_btn" type="button">J6+</button></td>
                    <td> <div align="center" id="j6_pos_limit"> N/A </div> </td>
                    <td> <input type="text" id="j6_angle_in" placeholder="deg_j6" value="0" > </td>
                </tr>
                <tr>
                    <td> <div align="center" id="j7_neg_limit"> N/A </div> </td>
                    <td> <button id="j7_neg_btn" type="button">J7-</button></td>
                    <td> <div align="center" id="j7_angle_out"> N/A </div> </td>
                    <td> <button id="j7_pos_btn" type="button">J7+</button></td>
                    <td> <div align="center" id="j7_pos_limit"> N/A </div> </td>
                    <td> <input type="text" id="j7_angle_in" placeholder="deg_j7" value="0" > </td>
                </tr>
                <tr>
                    <td> </td>
                    <td> </td>
                    <td> </td>
                    <td> </td>
                    <td> </td>
                    <td> <button id="j_angles_submit_btn" type="button">Move to angles!</button> </td>
                </tr>
                <tr>
                    <td COLSPAN="6"> <button id="stop_btn" type="button" >STOP! </button> </td>
                </tr>
            </table>
        </template>

        <template id="template_TaskSpaceControl">
            <table id="table_TaskSpaceControl" border="1" >
                <Tr>
                    <TH align="center" COLSPAN="2"> <H3>Task Space Control</H3> </TH>
                </Tr>
                <Tr>
                    <TH align="center" COLSPAN="2"> <H4>Position</H4> </TH>
                </Tr>
                <tr>
                    <td> <button id="X_neg_btn" type="button">X-</button> </td>
                    <td> <button id="X_pos_btn" type="button">X+</button> </td>
                </tr>
                <tr>
                    <td > <button id="Y_neg_btn" type="button">Y-</button> </td>
                    <td > <button id="Y_pos_btn" type="button">Y+</button> </td>
                </tr>         
                <tr>
                    <td > <button id="Z_neg_btn" type="button">Z-</button> </td>
                    <td > <button id="Z_pos_btn" type="button">Z+</button> </td>
                </tr>
                <Tr>
                    <TH align="center" COLSPAN="2"> <H4><br>Orientation</H4> </TH>
                </Tr>      
                <tr>
                    <td > <button id="theta_X_neg_btn" type="button">&theta;<sub>X</sub>-</button> </td>
                    <td > <button id="theta_X_pos_btn" type="button">&theta;<sub>X</sub>+</button> </td>
                </tr>  
                <tr>
                    <td > <button id="theta_Y_neg_btn" type="button">&theta;<sub>Y</sub>-</button> </td>
                    <td > <button id="theta_Y_pos_btn" type="button">&theta;<sub>Y</sub>+</button> </td>
                </tr>
                <tr>
                    <td >  <button id="theta_Z_neg_btn" type="button">&theta;<sub>Z</sub>-</button> </td>
                    <td > <button id="theta_Z_pos_btn" type="button">&theta;<sub>Z</sub>+</button> </td>
                </tr>
                <tr>
                    <td COLSPAN="2">
                    <table style="text-align: center; display: block; border: 1px solid; ">
                        <Tr> <TH > <H4>Current Pose wrt Base</H4> </TH> </Tr>
                        <tr> <td align="left"> ZYX Angles (deg):  </td> </tr>
                        <tr> <td> <div align="left" id="cur_ZYX_angles"></div> </td></tr>
                        <tr> <td align="left"> Position (m): </td> </tr>
                        <tr> <td> <div align="left" id="cur_position"></div>  </td></tr>    
                    </table>
                    </td>
                </tr>  
            </table>
        </template>

        <template id="template_SavePlaybackPoses">
            <table id="table_SavePlaybackPoses" border="1" > 
                <Tr>
                    <TH align="center" COLSPAN="3"> <H3>Save & Playback Poses</H3> </TH>
                </Tr>
                <Tr>
                    <TH align="center" COLSPAN="3"> <H4>Saved Poses</H4> </TH>
                </Tr>
                     
                <tr>
                    <td COLSPAN="3"> 
                          <select id="saved_poses_list" name="saved_poses_list" size="5" multiple style="width: 100%; font-size: 16px;">
                            <!-- <option value="0,0,0,0,0,0,0">0,0,0,0,0,0,0</option> -->
                          </select>
                    </td>    
                </tr>
                
                <tr>
                    <td COLSPAN="3"> <button id="save_pose_btn" type="button" style="width: 100%;">SAVE Current Pose</button> </td>
                </tr>
                <tr>
                    <td COLSPAN="3"> <button id="up_sel_pose_btn" type="button" style="width: 100%;">Move UP Selected Pose</button> </td>
                </tr>
                <tr>
                    <td COLSPAN="3"> <button id="down_sel_pose_btn" type="button" style="width: 100%;">Move DOWN Selected Pose</button> </td>
                </tr>
                <tr>
                    <td COLSPAN="3"> <button id="del_sel_pose_btn" type="button" style="width: 100%;">REMOVE Selected Pose</button> </td>
                </tr>
                <tr>
                    <td COLSPAN="3"> <button id="go_sel_pose_btn" type="button" style="width: 100%;">GO to Selected Pose</button> </td>
                </tr>
                <tr>
                    <td> Speed (%): </td> 
                    <td> <input id="joint_vel_range" type="range" min="0" max="100" value="100" step="5" 
                        oninput="showJointVelValue()" onchange="showJointVelValue()"> </td>
                    <td> <div align="center" id="joint_vel_percentage"> 100 </div> </td> 
                </tr>
                <tr>
                    <td COLSPAN="2"> Number of Loops: </td> 
                    <td> <input type="number" id="num_loops_in" placeholder="number of loops" value="1" min="1"> </td>
                </tr>
                <tr>
                    <td COLSPAN="2"> Loop Time (s): </td> 
                    <td> <input type="number" id="time_loops_in" placeholder="1 Loop time when speed is 100%" value="10.0" min="0" step="0.5"> </td>
                </tr>
                <tr>
                     <td COLSPAN="3"> <button id="playback_poses_btn" type="button" style="width: 100%;">(GO to initial pose and) <br> PLAYBACK Saved Poses!</button> </td>
                </tr>
            </table>
        </template>

        <template id="template_RobotStatus"> 
            <table id="table_RobotStatus" border="1"  > <!-- CELLPADDING="4" CELLSPACING="3"> -->
                <Tr>
                    <TH align="center" COLSPAN="2">
                        <H3><BR> Robot Status</H3>
                    </TH>
                </Tr>
                
                <tr>              
                    <TH> Robot State Flags: </TH>
                    <td>
                        <div align="left" id="print_div_flag_info"></div>
                    </td>
                </tr>
                
                <tr>              
                    <TH>Joint Kinematic Info: </TH>
                    <td>
                        <div align="left" id="print_div_kin_info"></div>
                    </td>
                </tr>
                
                
                <tr>              
                    <TH>Number of Joints:<br>
                        Joints Types (0:unkown, 1:revolute, 2:continuous, 3:prismatic, 4:wheel):<br>
                        Joint Velocity Limits:<br>
                        Joint Acceleration Limits:<br>
                    </TH>
                    <td>
                        <div align="left" id="print_div_num_info"></div>
                    </td>
                </tr>
                
                <tr>              
                    <TH>End Effector Pose (wrt. Base Frame): </TH>
                    <td>
                        <div align="left" id="print_div_end_info"></div>
                    </td>
                </tr>
                
                <tr>              
                    <TH>Desired Pose:<br>
                        Desired Inverse Kinematics Joint Angles (deg, rad):<br>
                        Is IK Solution Converged:
                    </TH>
                    <td>
                        <div align="left" id="print_div_ik_info"></div>
                    </td>
                </tr>
            </table>
        </template>

        <!-- Camera Feedback Area Template -->
        <template id="template_CameraFeedback"> 
            <table id="table_CameraFeedback" border="1"  > <!-- CELLPADDING="4" CELLSPACING="3"> -->
                <tr> 
                    <td>
                        <form>
                            <label for="chosen_cam">Camera:</label>
                            <!-- <select name="available_cams" id="available_cams" onchange="run_vision()"> -->
                            <select name="available_cams" id="available_cams">
                                <!-- <option value="cam0">Cam0</option>
                                <option value="cam1">Cam1</option> -->
                            </select>
                        </form>
                    </td>          
                </tr>
                <tr> 
                    <td>
                        <!-- <canvas id="camera_image" width="320" height="240"></canvas> -->
                        <img id="camera_image">
                    </td>          
                </tr>
            </table>
        </template>

        <!-- Train Vision Area template -->
        <template id="template_TrainVision"> 
            <table id="table_TrainVision" border="1"  > <!-- CELLPADDING="4" CELLSPACING="3"> -->
                <col width="160"><col >
                <tr> 
                    <td colspan = "2" align="left">
                        <form>
                            <label for="trained_visuals">Trained Visuals:</label>
                            <select name="trained_visuals" id="trained_visuals">
                                <!-- <option value="vis0">Visual_00</option> -->
                            </select>
                        </form>
                    </td>          
                </tr>
                <tr> 
                    <td rowspan="2">
                        <img id="selected_trained_visual"></img>
                    </td>   
                    <td COLSPAN="1"> <button id="edit_name_selected_trained_visual_btn" type="button" style="width: 100%;">Edit Name</button> </td>  
                </tr>

                <tr> 
                    <td COLSPAN="1"> <button id="delete_selected_trained_visual_btn" type="button" style="width: 100%;">Delete</button> </td>         
                </tr>
                <tr> 
                    <td COLSPAN="2"> <button id="train_new_visual_btn" type="button" style="width: 100%;">Train New Visual</button> </td>         
                </tr>
            </table>

            <div id="modal_TrainVision" class="modal">

              <!-- Modal content -->
              <div class="modal-content">

                <div class="modal-header">
                  <span id="span_close" class="close">&times;</span>
                  <h2>Crop the image</h2>
                </div>

                <div class="modal-body">
                  <!-- <p>Some text in the Modal Body</p> -->
                  <div class="img-container">
                    <!-- <img id="image" src="../images/picture.jpg" alt="Picture"> -->
                    <!-- <img id="image" src="https://fengyuanchen.github.io/cropperjs/images/picture.jpg" alt="Picture"> -->
                    <img id="training_image">
                  </div>
                </div>

                <div class="modal-footer">
                  <!-- <h2>Modal Footer</h2> -->
                  <button type="button" id="btn_close">Cancel</button>

                  <button type="button" id="btn_reset">Reset</button>
                  <button type="button" id="btn_rot_m5">Rotate -5 deg</button>
                  <button type="button" id="btn_rot_p5">Rotate +5 deg</button>
                  
                  
                  <button type="button" id="btn_crop">Crop & Save</button>
                </div>

              </div>

            </div>
        </template>

        <!-- Camera Calibration Area Template -->
        <template id="template_CameraCalibration"> 
            <table id="table_CameraCalibration" border="1"  > <!-- CELLPADDING="4" CELLSPACING="3"> -->
                <col><col>
                <tr> 
                    <td colspan = "2" align="left">
                        <form>
                            <label for="calibrated_cameras">Calibrated Cameras:</label>
                            <select name="calibrated_cameras" id="calibrated_cameras">
                                <!-- <option value="cam0">Camera_00</option> -->
                            </select>
                        </form>
                    </td>          
                </tr>

                <tr> 
                    <td align="right">Camera Matrix: </td>   
                    <td>
                        <div align="left" id="print_div_selected_camera_matrix"></div>
                    </td>       
                </tr>
                <tr> 
                    <td align="right">Distortion Coefficients: </td>   
                    <td>
                        <div align="left" id="print_div_selected_camera_distortion_coefficients"></div>
                    </td>       
                </tr>
                <tr> 
                    <td align="right">[R|t] of the 1st Calibration Pattern: </td>   
                    <td>
                        <div align="left" id="print_div_selected_camera_RnT"></div>
                    </td>       
                </tr>
                <tr> 
                    <td align="right">RMS re-projection error: </td>   
                    <td>
                        <div align="left" id="print_div_selected_camera_calibration_error"></div>
                    </td>          
                </tr>
                <tr>
                    <td> <button id="delete_calibration_btn" type="button" style="width: 100%;">Delete</button> </td> 
                    <td> <button id="calibrate_camera_btn" type="button" style="width: 100%;">Calibrate New</button> </td>         
                </tr>
            </table>

            <div id="modal_CameraCalibration" class="modal">

              <!-- Modal content -->
              <div class="modal-content">

                <div class="modal-header">
                  <span id="span_close_calibration" class="close">&times;</span>
                  <h2>Calibrate the Camera with a Checker Board </h2>
                </div>

                <div class="modal-body" id="modal_body_CameraCalibration">
                  <p>You need to use a planar Checker Board as the calibration object</p>
                  <p>If the selected camera is already calibrated, it will be overwritten. Otherwise a new calibration will be added.</p>
                  <table id="table_calibration_modal" border="1"> <!-- CELLPADDING="4" CELLSPACING="3"> -->
                      <col width="80%"><col width="20%"> <!-- It does not work, see css -->
                      <tr> 
                          <td align="left">Please enter the Number of Squares in the WIDTH of the checker board: </td>   
                          <td>
                              <input type="number" id="width_checkerboard_input" placeholder="width squares" value="8" min="1" style="font-size: 25px;">
                          </td>       
                      </tr>
                      <tr> 
                          <td align="left">Please enter the Number of Squares in the HEIGHT of the checker board: </td>   
                          <td>
                              <input type="number" id="height_checkerboard_input" placeholder="height squares" value="7" min="1" style="font-size: 25px;">
                          </td>       
                      </tr>
                      <tr> 
                          <td align="left">Please enter one side length of the squares (in millimeters): </td>   
                          <td> 
                            <input type="number" id="square_size_input" placeholder="one side length of the squares (mm)" value="29.0" min="0" step="0.5" style="font-size: 25px;"> 
                          </td>     
                      </tr>
                      <tr> 
                          <td colspan = "2" align="left">Now capture checkerboard images from different positions and orientations </td>        
                      </tr>
                      <tr> 
                          <td align="left">For better results, at least 10 images are needed. </td>   
                          <td> <button id="capture_img_calibration_btn" type="button" style="width: 100%;">Capture Image</button> </td>      
                      </tr>
                      <tr> 
                          <td>
                              <img id="calibration_camera_image"></img>
                          </td>   
                          <td >
                            <div align="center" id="print_div_num_captured_calibration_imgs"></div> 
                          </td>  
                      </tr>
                  </table>
                </div>

                <div class="modal-footer">
                  <!-- <h2>Modal Footer</h2> -->
                  <button type="button" id="btn_close_calibration">Cancel</button>
                  <button type="button" id="btn_calibrate_n_save">Calibrate & Save</button>
                </div>

              </div>

            </div>
        </template>

        <!-- Camera Tracking Area Template -->
        <template id="template_CameraTracking"> 
            <table id="table_CameraTracking" border="1"  > <!-- CELLPADDING="4" CELLSPACING="3"> -->
                <tr> 
                    <td > <button id="test_detection_btn" type="button" style="width: 100%;">Test Detection</button> </td>         
                </tr>
                <tr> 
                    <td>Selected Camera: 
                        <div align="left" id="print_div_test_selected_camera"></div>
                    </td>
                </tr>
                <tr> 
                    <td>Selected Visual: 
                        <div align="left" id="print_div_test_selected_visual"></div>
                    </td>
                </tr>
                <tr> 
                    <td>
                        <!-- <canvas id="camera_image" width="320" height="240"></canvas> -->
                        <img id="test_detection_result_image">
                    </td>          
                </tr>
                <!-- <tr> 
                    <td>Selected Camera Image Size: 
                        <div align="left" id="print_div_test_selected_camera_img_size"></div>
                    </td>
                </tr>
                <tr> 
                    <td>Selected Visual Image Size: 
                        <div align="left" id="print_div_test_selected_visual_img_size"></div>
                    </td>
                </tr> -->
                <tr> 
                    <td>Detected Object Size(width,height): 
                        <div align="left" id="print_div_test_detected_obj_size"></div>
                    </td>
                </tr>
                <tr> 
                    <td>Detected Object Center Coordinates in Camera Image Frame (x,y): 
                        <div align="left" id="print_div_test_detected_obj_coordinates"></div>
                    </td>
                </tr>
                <tr> 
                    <td>Detected Object Rotation Angle (+: CCW, -: CW): 
                        <div align="left" id="print_div_test_detected_obj_angle"></div>
                    </td>
                </tr>
            </table>
        </template>

        <!-- print_div for debug texts -->
        <template id="template_print_div">
            <div id="print_div"></div> 
        </template>

        <!-- Blockly Generated Code Area Template -->
        <template id="template_BlocklyCode">
            <table id="table_BlocklyCode"  border="1" > <!--  -->
                <!-- <Tr>
                    <TH align="left"> <H4>JavaScript Code:</H4> </TH>
                </Tr>
                <tr> 
                    <td>
                        <textarea readonly id="textareaBlocklyJS" placeholder="Blockly generated Javascript code will be seen here.."> </textarea>
                    </td>
                </tr> -->
                <Tr>
                    <TH align="left"> <H4>Python Code:</H4> </TH>
                </Tr>
                <tr> 
                    <td>
                        <textarea readonly id="textareaBlocklyPy" placeholder="Blockly generated Python code will be seen here.."> </textarea>
                    </td>
                </tr>

                <tr style="height: 10%;"> 
                    <td>
                        <button id="execute_blockly_btn" type="button">Execute Blockly Code</button>
                    </td>
                </tr>
            </table>
        </template>

        <!-- Blockly File Browser -->
        <template id="template_BlocklyBrowser">
            <table id="table_BlocklyBrowser" border="1" > 
                <Tr>
                    <TH align="center" COLSPAN="3"> <H3>Blockly Browser</H3> </TH>
                </Tr>
                <Tr>
                    <TH align="center" COLSPAN="3"> <H4>Saved Blocks</H4> </TH>
                </Tr>
                     
                <tr>
                    <td COLSPAN="3"> 
                          <select id="saved_blocks_list" name="saved_blocks_list" size="5" multiple style="height:100%; width:100%; font-size: 16px;">
                            <!-- <option value="0,0,0,0,0,0,0">0,0,0,0,0,0,0</option> -->
                          </select>
                    </td>    
                </tr>
                
                <tr>
                    <td> <button id="save_blocks_btn" type="button" style="width: 100%;">SAVE</button> </td>
                    <td> <button id="save_as_blocks_btn" type="button" style="width: 100%;">SAVE AS</button> </td>
                    <td> <button id="edit_blocks_name_btn" type="button" style="width: 100%;">EDIT NAME</button> </td>
                </tr>
                <tr>
                    <td> <button id="load_blocks_btn" type="button" style="width: 100%;">LOAD</button> </td>
                    <td> <button id="clear_blocks_btn" type="button" style="width: 100%;">CLEAR</button> </td>
                    <td> <button id="delete_blocks_btn" type="button" style="width: 100%;">DELETE</button> </td>
                </tr>
            </table>
            
        </template>

        <!-- Blockly Interface Template -->
        <template id="template_BlocklyWorkspace">
            <table id="table_BlocklyWorkspace"   > <!-- border="1" -->
                <tr> 
                    <td id="blocklyArea">
                        <div id="blocklyDiv"></div> 

                        <!-- Blockly Structure of the toolbox -->
                        <xml xmlns="https://developers.google.com/blockly/xml" id="toolbox" >
                            <category name="Logic" colour="%{BKY_LOGIC_HUE}">
                                <category name="If">
                                    <block type="controls_if"></block>
                                    <block type="controls_if">
                                        <mutation else="1"></mutation>
                                    </block>
                                    <block type="controls_if">
                                        <mutation elseif="1" else="1"></mutation>
                                    </block>
                                </category>
                                <category name="Boolean" colour="%{BKY_LOGIC_HUE}">
                                    <block type="logic_compare"></block>
                                    <block type="logic_operation"></block>
                                    <block type="logic_negate"></block>
                                    <block type="logic_boolean"></block>
                                    <block type="logic_null"></block>
                                    <block type="logic_ternary"></block>
                                </category>
                            </category>
                            <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
                            <category name="Loops" colour="%{BKY_LOOPS_HUE}">
                                <block type="controls_repeat_ext">
                                    <value name="TIMES">
                                        <block type="math_number">
                                            <field name="NUM">10</field>
                                        </block>
                                    </value>
                                </block>
                                <block type="controls_whileUntil"></block>
                                <block type="controls_for">
                                    <field name="VAR">i</field>
                                    <value name="FROM">
                                        <block type="math_number">
                                            <field name="NUM">1</field>
                                        </block>
                                    </value>
                                    <value name="TO">
                                        <block type="math_number">
                                            <field name="NUM">10</field>
                                        </block>
                                    </value>
                                    <value name="BY">
                                        <block type="math_number">
                                            <field name="NUM">1</field>
                                        </block>
                                    </value>
                                </block>
                                <block type="controls_forEach"></block>
                                <block type="controls_flow_statements"></block>
                            </category>
                            <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
                            <category name="Math" colour="%{BKY_MATH_HUE}">
                                <block type="math_number">
                                    <field name="NUM">123</field>
                                </block>
                                <block type="math_arithmetic"></block>
                                <block type="math_single"></block>
                                <block type="math_trig"></block>
                                <block type="math_constant"></block>
                                <block type="math_number_property"></block>
                                <block type="math_round"></block>
                                <block type="math_on_list"></block>
                                <block type="math_modulo"></block>
                                <block type="math_constrain">
                                    <value name="LOW">
                                        <block type="math_number">
                                            <field name="NUM">1</field>
                                        </block>
                                    </value>
                                    <value name="HIGH">
                                        <block type="math_number">
                                            <field name="NUM">100</field>
                                        </block>
                                    </value>
                                </block>
                                <block type="math_random_int">
                                    <value name="FROM">
                                        <block type="math_number">
                                            <field name="NUM">1</field>
                                        </block>
                                    </value>
                                    <value name="TO">
                                        <block type="math_number">
                                            <field name="NUM">100</field>
                                        </block>
                                    </value>
                                </block>
                                <block type="math_random_float"></block>
                                <block type="math_atan2"></block>
                            </category>
                            <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
                            <category name="Lists" colour="%{BKY_LISTS_HUE}">
                                <block type="lists_create_empty"></block>
                                <block type="lists_create_with"></block>
                                <block type="lists_repeat">
                                    <value name="NUM">
                                        <block type="math_number">
                                            <field name="NUM">5</field>
                                        </block>
                                    </value>
                                </block>
                                <block type="lists_length"></block>
                                <block type="lists_isEmpty"></block>
                                <block type="lists_indexOf"></block>
                                <block type="lists_getIndex"></block>
                                <block type="lists_setIndex"></block>
                            </category>
                            <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
                            <category name="Text" colour="%{BKY_TEXTS_HUE}">
                                <block type="text"></block>
                                <block type="text_length"></block>
                                <block type="text_print"></block>
                                <!-- <block type="print_div"></block> -->
                            </category>
                            <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
                            <sep></sep>
                            <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
                            <category name="Variables" custom="VARIABLE" colour="%{BKY_VARIABLES_HUE}">
                            </category>
                            <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
                            <category name="Functions" custom="PROCEDURE" colour="%{BKY_PROCEDURES_HUE}">
                            </category>
                            <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
                            <sep></sep>
                            <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
                            <category name="Robot" colour="0">
                                <category name="JointSpaceJog">
                                    <block type="robot_jog_joint_not_relative">
                                        <value name="DEGREE">
                                            <block type="math_number">
                                                <field name="NUM">0</field>
                                            </block>
                                        </value>
                                    </block>
                                    <block type="robot_jog_joint_relative">
                                        <value name="DEGREE">
                                            <block type="math_number">
                                                <field name="NUM">5</field>
                                            </block>
                                        </value>
                                    </block>
                                    <block type="robot_jog_joints_not_relative">
                                        <value name="DEGREE_1">
                                            <block type="math_number">
                                                <field name="NUM">0</field>
                                            </block>
                                        </value>
                                        <value name="DEGREE_2">
                                            <block type="math_number">
                                                <field name="NUM">0</field>
                                            </block>
                                        </value>
                                        <value name="DEGREE_3">
                                            <block type="math_number">
                                                <field name="NUM">0</field>
                                            </block>
                                        </value>
                                        <value name="DEGREE_4">
                                            <block type="math_number">
                                                <field name="NUM">0</field>
                                            </block>
                                        </value>
                                        <value name="DEGREE_5">
                                            <block type="math_number">
                                                <field name="NUM">0</field>
                                            </block>
                                        </value>
                                        <value name="DEGREE_6">
                                            <block type="math_number">
                                                <field name="NUM">0</field>
                                            </block>
                                        </value>
                                        <value name="DEGREE_7">
                                            <block type="math_number">
                                                <field name="NUM">0</field>
                                            </block>
                                        </value>
                                    </block>
                                    <block type="robot_jog_joints_relative">
                                        <value name="DEGREE_1">
                                            <block type="math_number">
                                                <field name="NUM">10</field>
                                            </block>
                                        </value>
                                        <value name="DEGREE_2">
                                            <block type="math_number">
                                                <field name="NUM">0</field>
                                            </block>
                                        </value>
                                        <value name="DEGREE_3">
                                            <block type="math_number">
                                                <field name="NUM">0</field>
                                            </block>
                                        </value>
                                        <value name="DEGREE_4">
                                            <block type="math_number">
                                                <field name="NUM">0</field>
                                            </block>
                                        </value>
                                        <value name="DEGREE_5">
                                            <block type="math_number">
                                                <field name="NUM">0</field>
                                            </block>
                                        </value>
                                        <value name="DEGREE_6">
                                            <block type="math_number">
                                                <field name="NUM">0</field>
                                            </block>
                                        </value>
                                        <value name="DEGREE_7">
                                            <block type="math_number">
                                                <field name="NUM">0</field>
                                            </block>
                                        </value>
                                    </block>
                                </category>
                                <category name="CartesianSpaceJog">
                                    <block type="robot_jog_cartesian_not_relative">
                                        <value name="POSITION">
                                            <block type="utils_position">
                                                <value name="X">
                                                    <block type="math_number">
                                                        <field name="NUM">0</field>
                                                    </block>
                                                </value>
                                                <value name="Y">
                                                    <block type="math_number">
                                                        <field name="NUM">0</field>
                                                    </block>
                                                </value>
                                                <value name="Z">
                                                    <block type="math_number">
                                                        <field name="NUM">0</field>
                                                    </block>
                                                </value>
                                            </block>
                                        </value>
                                        <value name="ORIENTATION">
                                            <block type="utils_orientation">
                                                <value name="TX">
                                                    <block type="math_number">
                                                        <field name="NUM">0</field>
                                                    </block>
                                                </value>
                                                <value name="TY">
                                                    <block type="math_number">
                                                        <field name="NUM">0</field>
                                                    </block>
                                                </value>
                                                <value name="TZ">
                                                    <block type="math_number">
                                                        <field name="NUM">0</field>
                                                    </block>
                                                </value>
                                            </block>
                                        </value>
                                    </block>
                                    <block type="robot_jog_cartesian_relative">
                                        <value name="POSITION">
                                            <block type="utils_position">
                                                <value name="X">
                                                    <block type="math_number">
                                                        <field name="NUM">0</field>
                                                    </block>
                                                </value>
                                                <value name="Y">
                                                    <block type="math_number">
                                                        <field name="NUM">0</field>
                                                    </block>
                                                </value>
                                                <value name="Z">
                                                    <block type="math_number">
                                                        <field name="NUM">0</field>
                                                    </block>
                                                </value>
                                            </block>
                                        </value>
                                        <value name="ORIENTATION">
                                            <block type="utils_orientation">
                                                <value name="TX">
                                                    <block type="math_number">
                                                        <field name="NUM">0</field>
                                                    </block>
                                                </value>
                                                <value name="TY">
                                                    <block type="math_number">
                                                        <field name="NUM">0</field>
                                                    </block>
                                                </value>
                                                <value name="TZ">
                                                    <block type="math_number">
                                                        <field name="NUM">0</field>
                                                    </block>
                                                </value>
                                            </block>
                                        </value>
                                    </block>
                                </category>
                                <block type="robot_wait"></block>
                            </category>
                            <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
                            <sep></sep>
                            <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
                            <category name="Camera" colour="180">
                                <block type="camera_get_object_pose_z_required">
                                    <value name="Z_DISTANCE">
                                        <block type="math_number">
                                            <field name="NUM">1.0</field>
                                        </block>
                                    </value>
                                </block>
                                <block type="camera_get_object_pose_z_not_required">
                                    
                                </block>
                                <block type="camera_transform_pose_to_robot">
                                    
                                </block>
                            </category>   
                            <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
                            <sep></sep>
                            <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
                            <category name="Utilities" colour="200">
                                <block type="utils_position">
                                    <value name="X">
                                        <block type="math_number">
                                            <field name="NUM">0</field>
                                        </block>
                                    </value>
                                    <value name="Y">
                                        <block type="math_number">
                                            <field name="NUM">0</field>
                                        </block>
                                    </value>
                                    <value name="Z">
                                        <block type="math_number">
                                            <field name="NUM">0</field>
                                        </block>
                                    </value>
                                </block>
                                <block type="utils_orientation">
                                    <value name="TX">
                                        <block type="math_number">
                                            <field name="NUM">0</field>
                                        </block>
                                    </value>
                                    <value name="TY">
                                        <block type="math_number">
                                            <field name="NUM">0</field>
                                        </block>
                                    </value>
                                    <value name="TZ">
                                        <block type="math_number">
                                            <field name="NUM">0</field>
                                        </block>
                                    </value>
                                </block>
                                <block type="utils_pose_from_position_n_orientation">
                                    <value name="POSITION">
                                        <block type="utils_position">
                                            <value name="X">
                                                <block type="math_number">
                                                    <field name="NUM">0</field>
                                                </block>
                                            </value>
                                            <value name="Y">
                                                <block type="math_number">
                                                    <field name="NUM">0</field>
                                                </block>
                                            </value>
                                            <value name="Z">
                                                <block type="math_number">
                                                    <field name="NUM">0</field>
                                                </block>
                                            </value>
                                        </block>
                                    </value>
                                    <value name="ORIENTATION">
                                        <block type="utils_orientation">
                                            <value name="TX">
                                                <block type="math_number">
                                                    <field name="NUM">0</field>
                                                </block>
                                            </value>
                                            <value name="TY">
                                                <block type="math_number">
                                                    <field name="NUM">0</field>
                                                </block>
                                            </value>
                                            <value name="TZ">
                                                <block type="math_number">
                                                    <field name="NUM">0</field>
                                                </block>
                                            </value>
                                        </block>
                                    </value>
                                </block>
                                <block type="utils_position_in_pose">
                                    
                                </block>
                                <block type="utils_orientation_in_pose">
                                    
                                </block>
                                <block type="utils_arithmetic">
                                    
                                </block>
                            </category>
                            <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
                            <sep></sep>
                            <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
                            <category name="Tools" colour="60">
                                <block type="tool_gripper">
                                </block>
                            </category> 
                        </xml>
                    </td>          
                </tr>
            </table>            
        </template>

        <!-- Golden Layout JS -->
        <script type="text/javascript" src="./scripts-GL.js" class="gl_keep"></script>

        <!-- Blockly JS -->
        <script type="text/javascript" src="./scripts-Blockly.js"></script>

        <!-- Gamepad JS -->
        <!-- <script type="text/javascript" src="./scripts-gamepad.js"></script> -->

        <!-- Space Navigator (space mouse as gamepad) -->
        <script type="text/javascript" src="./scripts-space_navigator.js"></script>


    </body>
</html>